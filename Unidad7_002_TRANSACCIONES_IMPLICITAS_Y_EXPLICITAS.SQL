USE DB_Educacion_IT
GO
--1) TRANSACCIONES IMPLICITAS: LA TRANSACCIÓN NO SE ABRE EN FORMA OCULTA, PARA CADA INSTRUCCIÓN
SET IMPLICIT_TRANSACTIONS ON

--SELECT * FROM dbo.TMP_PRODUCTO WHERE ID = 3

UPDATE dbo.TMP_PRODUCTO set descripcion = 'Corbata diney PRUEBA 1'
WHERE id = 3
commit;
--rollback;

SELECT * FROM dbo.TMP_PRODUCTO WHERE ID = 3

--------------------------------------------------------------------------------------------------------
--EJECUTARLO EN OTRA VENTANA
--2) TRANSACCIONES EXPLICITAS: LA TRANSACCIÓN SE ABRE EN FORMA OCULTA, PARA CADA INSTRUCCIÓN
SET IMPLICIT_TRANSACTIONS OFF

	--A) OBSERVAR QUE NO SE ABRE NINGUNA TRANSACCIÓN. (Y AL HACER ROLLBACK, DA ERROR PORQUE NO SE ABRIO NINGUNA TRANSACCIÓN)
	UPDATE dbo.TMP_PRODUCTO set descripcion = 'Corbata diney PRUEBA 2'
	WHERE id = 3
	rollback;
	SELECT * FROM dbo.TMP_PRODUCTO WHERE ID = 3

	--B) ABRIR EXPLICITAMENTE LA TRANSACCIÓN
	BEGIN TRANSACTION
		DELETE FROM dbo.TMP_PRODUCTO WHERE id = 3
		select * from dbo.TMP_PRODUCTO where id= 3
		rollback;
		--COMMIT TRANSACTION
		select * from dbo.TMP_PRODUCTO where id= 3
